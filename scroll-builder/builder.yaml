base_path: "/media/julian/2"
scripts:
  render_surface_volumes:
    variables:
      scroll: "[^/]*?.volpkg"
      path_id: "scroll-builder-test_[0-9]+"
      obj_id: "[0-9]+"
      path: "${scroll}/${path_id}"
    permutations:
      - "${path}/${obj_id}.obj"
    on_change:
      - "${base_path}/${path}/${obj_id}.obj"
      - "/home/julian/gitThaumato/ThaumatoAnakalyptor/ThaumatoAnakalyptor/mesh_to_surface.py"
    recompute_untracked: True
    recompute_allways: False
    commands:
      - command1:
        docker_command: 
          volumes: 
            -   host_path: "${base_path}/${scroll}"
                container_path: "/scroll.volpkg"
                write_access: False
            -   host_path: "${base_path}/${scroll}/${path_id}"
                container_path: "/scroll.volpkg/${path_id}"
                write_access: True
            -   host_path: "/home/julian/gitThaumato/ThaumatoAnakalyptor/"
                container_path: "/workspace"
                write_access: True
            -   host_path: "/tmp/.X11-unix"
                container_path: "/tmp/.X11-unix"
          environment:
            DISPLAY: "DISPLAY"
          name: "thaumato_image"
        script_commands: 
          - "python3 -m ThaumatoAnakalyptor.mesh_to_surface /scroll.volpkg/${path_id}/${obj_id}.obj /scroll.volpkg/volumes/scroll1_grids --display"
