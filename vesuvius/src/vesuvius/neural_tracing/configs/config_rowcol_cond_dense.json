{
    "out_dir": "/mnt/raid_nvme/datasets/results/neural_tracer/rowcol_cond_frontback_disp_v9",
    "seed": 10,
    "batch_size": 2,
    "num_workers": 10,
    "val_num_workers": 0,
    "persistent_workers": false,

    "dataloader_multiprocessing_context": "spawn",

    "datasets": [
        {
            "volume_path": "/mnt/raid_nvme/volpkgs/PHerc0139_ds2.volpkg/volumes/0139_2um_ds2_raw.zarr",
            "volume_scale": 0,
            "segments_path": "/mnt/raid_nvme/datasets/raw/neural_tracer_022826/PHerc0139/tifxyz",
            "z_range": [2000, 7000]
        },
        {
            "volume_path": "/mnt/raid_nvme/volpkgs/Scroll4.volpkg/volumes/s4.zarr",
            "volume_scale": 0,
            "segments_path": "/mnt/raid_nvme/datasets/raw/neural_tracer_022826/PHerc1667/tifxyz",
            "z_range": [3500, 9000]
        },
        {
            "volume_path": "/mnt/raid_nvme/volpkgs/PHercParis4.volpkg/volumes/s1_uint8.zarr",
            "volume_scale": 0,
            "segments_path": "/mnt/raid_nvme/datasets/raw/neural_tracer_022826/PHercParis4/tifxyz",
            "z_range": [1000, 9250]
        },
        {
            "volume_path": "/mnt/raid_nvme/volpkgs/0343P.volpkg/volumes/2.24um_raw_ds2_ome_v2.zarr",
            "volume_scale": 0,
            "segments_path": "/mnt/raid_nvme/datasets/raw/neural_tracer_022826/PHerc0343p/tifxyz",
            "z_range": [1314, 3000]
        },
        {
            "volume_path": "/mnt/raid_nvme/volpkgs/PHercMANBp.volpkg/volumes/PHercMANBp-ct-2um.zarr",
            "volume_scale": 2,
            "segments_path": "/mnt/raid_nvme/datasets/raw/neural_tracer_022826/PHercMANBp/tifxyz",
            "z_range": [1000, 3000]
        }
        ,
        {
            "volume_path": "/mnt/raid_nvme/volpkgs/0500P2.volpkg/volumes/111keV_1.2m_scroll-fragment-0500P2_8um.zarr",
            "volume_scale": 0,
            "segments_path": "/mnt/raid_nvme/datasets/raw/neural_tracer_022826/PHerc0500p2/tifxyz",
            "z_range": [1700, 6000]
        }
    ],

    "verbose": false,

    "crop_size": [96, 256, 256],
    "chunk_pad": 20.0,
    "force_recompute_patches": false,
    "overlap_fraction": 0.25,
    "sample_mode": "wrap",
    "val_fraction": 0.01,
    "use_dense_displacement": true,
    "use_triplet_wrap_displacement": true,
    "use_triplet_direction_priors": true,
    "triplet_direction_prior_mask": "cond",
    "triplet_overlap_filter_mode": "any_masked_pixel",
    "triplet_close_distance_voxels": 1,
    "triplet_gt_vector_dilation_radius": 1.0,
    "triplet_dense_weight_mode": "all",
    "triplet_band_padding_voxels": 0.0,
    "triplet_band_distance_percentile": 100.0,
    "extrapolation_method": "rbf",
    "rbf_downsample_factor": 4,
    "cond_percent": [0.10, 0.50],
    "supervise_conditioning": false,
    "cond_supervision_weight": 0.15,
    "cond_local_perturb": {
        "enabled": true,
        "probability": 0.50,
        "num_blobs": [1, 6],
        "points_affected": 250,
        "amplitude_range": [1.0, 4.0],
        "max_total_displacement": 6.0,
        "radius_sigma_mult": 2.5
  },

    "use_other_wrap_cond": false,

    "lambda_smooth": 0.0,
    "displacement_supervision": "vector",
    "displacement_loss_type": "vector_huber_per_branch",
    "displacement_huber_beta": 3.0,
    "lambda_cond_disp": 0.00,
    "triplet_min_disp_vox": 1.0,
    "lambda_triplet_min_disp": 0.05,
    

    "use_dilation": false,
    "dilation_radius": 1,

    "num_iterations": 250000,
    "log_frequency": 100,
    "ckpt_frequency": 5000,

    "warmup_steps": 500,
    "grad_clip": 12,
    "optimizer": "sgd",
    "learning_rate": 0.01,
    "weight_decay": 0.00003,


    "mixed_precision": "bf16",
    "compile_model": true,

    "in_channels": 8,
    "model_type": "unet",

    "model_config": {},

    "augmentation": {
        "enabled": true
    }
}
