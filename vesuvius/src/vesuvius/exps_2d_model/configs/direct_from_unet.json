{
	"args": {
		"unet-checkpoint": "../../exps_2d/logs/20251205_125909_test_newgrad_lr1e-3/unet_current.pt",
		"crop": [2000, 2500, 1600, 1600],
		"input": "../s5/PHerc172.volpkg/volumes_webcache/s5_rechunked.zarr/0/",
		"out-dir": "res_direct",
		"mesh-step": 10.0,
		"winding-step": 10.0,
		"init-size-frac": 0.15,
		"init-size-frac-h": 2.0,
		"z-step": 10.0,
		"unet-z": 6000.0,
		"grad-mag-blur-sigma" : 4.0,
		"dir-blur-sigma" : 2.0
		},
	"base": {
		"dir_v": 10.0,
		"dir_conn": 1.0,
		"step": 100.0,
		"smooth_x": 0.0,
		"smooth_y": 0.01,
		"gradmag": 1.0,
		"mean_pos": 0.0,
		"meshoff_sy": 0.001,
		"conn_sy_l": 0.0,
		"conn_sy_r": 0.0,
		"angle": 0.001,
		"y_straight": 0.0,
		"data": 0.4,
		"data_plain": 0.2,
		"data_grad": 0.0,
		"z_straight": 10.0
	},
	"stages": [
		{
			"name": "global_only",
			"global_opt": {
				"steps": 1000,
				"lr": 0.001,
				"params": ["theta", "winding_scale"],
				"min_scaledown": 0
			}
		},
		{
			"name": "global",
			"steps": 5000,
			"lr": [0.1, 0.01, 0.001],
			"params": ["mesh_ms", "conn_offset_ms"],
			"min_scaledown": 0,
			"w_fac": {
				"data": 0.0,
				"data_plain": 0.0
			}
		},
		{
			"name": "snap",
			"steps": 5000,
			"lr": [0.1, 0.01, 0.001],
			"params": ["mesh_ms", "conn_offset_ms", "amp", "bias"],
			"min_scaledown": 0,
			"masks": [
				{
					"label": "cw_pie",
					"type": "central_winding_pie_ema",
					"ramp_start_it": 500,
					"center_off" : [0,5],
					"start_size_segs": 2,
					"ramp_stop_it": 4500,
					"blur_sigma": 3.0,
					"__losses": [],
					"losses": ["data","data_plain","data_grad"]
				}
			],
			"w_fac": {
				"data": 1.0,
				"data_plain": 1.0
			}
		}
	]
}

