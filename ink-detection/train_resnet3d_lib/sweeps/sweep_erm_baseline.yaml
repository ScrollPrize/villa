program: train_resnet3d.py
project: ink-group-dro
entity: vesuvius-challenge
method: grid

metric:
  name: val/worst_group_loss.min
  goal: minimize

parameters:
  training.objective:
    value: erm
  training.loss_mode:
    value: batch
  training.sampler:
    value: shuffle

  training_hyperparameters.training.accumulate_grad_batches:
    value: 1

  training_hyperparameters.training.lr:
    value: 1e-5

  training_hyperparameters.training.weight_decay:
    value: 1e-6

  training.stitch_all_val:
    value: true
  training.stitch_train:
    value: true
  training.stitch_downsample:
    value: 8

command:
  - ${env}
  - ${interpreter}
  - ${program}
  - --metadata_json
  - metadata-no500p2a.json
  - --outputs_path
  - /pscratch/cpa232_scrollprize/data/philodemos/2um_dataset/train_scrolls
