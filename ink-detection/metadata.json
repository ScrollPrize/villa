{
  "dataset_name": "2um_dataset",
  "description": "Collection of 2um resolution segments for ink detection training",
  "wandb": {
    "entity": "vesuvius-challenge",
    "project": "ink-group-dro"
  },
  "segments": {
    "20250807020208": {
      "original_path": "0175_2um/20250807020208",
      "base_path": "0139",
      "layer_range": [
        1,
        63
      ],
      "reverse_layers": false
    },
    "20250806145318": {
      "original_path": "0175_2um/20250806145318",
      "base_path": "0139",
      "layer_range": [
        1,
        63
      ],
      "reverse_layers": false
    },
    "l2_0_crop": {
      "original_path": "0139_segments/2um/l2_0_crop",
      "base_path": "0139",
      "layer_range": [
        1,
        63
      ],
      "reverse_layers": false
    },
    "658": {
      "original_path": "train_scrolls/658",
      "base_path": "343P",
      "layer_range": [
        1,
        63
      ],
      "reverse_layers": true
    },
    "500p2a": {
      "original_path": "train_scrolls/500p2a",
      "base_path": "500p2a",
      "layer_range": [
        1,
        63
      ],
      "reverse_layers": true
    },
    "-1": {
      "original_path": "sean_hiddenlayers/-1",
      "base_path": "500p2a",
      "layer_range": [
        1,
        63
      ],
      "reverse_layers": false
    },
    "20250910185200": {
      "original_path": "new_traces9b/david_9b",
      "base_path": "9b",
      "layer_range": [
        1,
        108
      ],
      "reverse_layers": false
    },
    "20250919125754-auto_grown_20250919055754487_inp_hr": {
      "original_path": "9b",
      "base_path": "9b",
      "layer_range": [
        1,
        108
      ],
      "reverse_layers": false
    }
  },
  "training_hyperparameters": {
    "model": {
    "model_name": "Unet",
    "backbone": "resnet3d",
    "in_chans": 62,
    "encoder_depth": 5,
    "norm": "batch",
    "group_norm_groups": 32,
    "target_size": 1
  },
    "training": {
      "size": 256,
      "tile_size": 1024,
      "stride": 128,
      "train_batch_size": 24,
      "valid_batch_size": 32,
      "use_amp": true,
      "epochs": 30,
      "scheduler": "OneCycleLR",
      "warmup_factor": 25,
      "cosine_warmup_pct": 0.15,
      "lr": 1e-05,
      "min_lr": 1e-06,
      "weight_decay": 1e-06,
      "exclude_weight_decay_bias_norm": true,
      "max_grad_norm": 100,
      "pretrained": true,
      "num_workers": 12,
      "layer_read_workers": 12,
      "seed": 130697
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.5,
      "shift_scale_rotate": {
        "rotate_limit": 360,
        "shift_limit": 0.15,
        "scale_limit": 0.1,
        "p": 0.75
      },
      "blur": {
        "types": [
          "GaussianBlur",
          "MotionBlur"
        ],
        "p": 0.4
      },
      "coarse_dropout": {
        "max_holes": 2,
        "max_width_ratio": 0.2,
        "max_height_ratio": 0.2,
        "p": 0.5
      }
    }
  },
  "training": {
    "objective": "erm",
    "sampler": "shuffle",
    "loss_mode": "batch",
    "erm_group_topk": 0,
    "save_every_epoch": true,
    "stitch_all_val": true,
    "stitch_train": true,
    "stitch_downsample": 8,
    "train_segments": [
      "20250806145318",
      "l2_0_crop",
      "658",
      "500p2a",
      "-1",
      "20250910185200",
      "20250919125754-auto_grown_20250919055754487_inp_hr"
    ],
    "val_segments": [
      "20250806145318",
      "l2_0_crop",
      "658",
      "500p2a",
      "-1",
      "20250910185200",
      "20250919125754-auto_grown_20250919055754487_inp_hr"
    ]
  },
  "group_dro": {
    "group_key": "base_path",
    "robust_step_size": 0.01
  },
  "source_file": "train_resnet3d.py"
}
